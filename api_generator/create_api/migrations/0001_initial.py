# Generated by Django 5.1.1 on 2025-05-14 12:26

import create_api.models
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Tag',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50, unique=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Tag',
                'verbose_name_plural': 'Tags',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='AIConversation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('app_name', models.CharField(blank=True, max_length=100, null=True)),
                ('file_path', models.CharField(blank=True, max_length=512, null=True)),
                ('file_type', models.CharField(blank=True, choices=[('template', 'Template'), ('model', 'Model'), ('view', 'View'), ('form', 'Form'), ('app', 'New App'), ('other', 'Other')], help_text='Type of file being edited', max_length=32, null=True)),
                ('status', models.CharField(choices=[('open', 'Open'), ('awaiting_clarification', 'Awaiting Clarification'), ('review', 'Review Diff'), ('closed', 'Closed'), ('cancelled', 'Cancelled')], default='open', max_length=32)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='AIMessage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('sender', models.CharField(choices=[('user', 'User'), ('assistant', 'Assistant')], max_length=16)),
                ('text', models.TextField()),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('conversation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='create_api.aiconversation')),
            ],
        ),
        migrations.CreateModel(
            name='Project',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('visibility', models.CharField(choices=[('private', 'Private'), ('public', 'Public')], default='private', max_length=10)),
                ('description', models.TextField(blank=True, null=True)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('project_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
                ('tags', models.ManyToManyField(blank=True, related_name='projects', to='create_api.tag')),
            ],
        ),
        migrations.CreateModel(
            name='App',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('app_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='apps', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='apps', to='create_api.tag')),
            ],
        ),
        migrations.AddField(
            model_name='aiconversation',
            name='project',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ai_conversations', to='create_api.project'),
        ),
        migrations.CreateModel(
            name='AIChangeRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('file_type', models.CharField(choices=[('template', 'Template'), ('model', 'Model'), ('view', 'View'), ('form', 'Form'), ('app', 'New App'), ('other', 'Other')], max_length=32)),
                ('file_path', models.CharField(blank=True, max_length=512, null=True)),
                ('diff', models.TextField()),
                ('files', models.JSONField(default=list, help_text='List of file paths this diff applies to')),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('applied', 'Applied'), ('rejected', 'Rejected')], default='draft', max_length=16)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('app_name', models.CharField(help_text="The Django app label (e.g. 'project_1_posts') this change targets", max_length=100)),
                ('conversation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='changes', to='create_api.aiconversation')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='create_api.project')),
            ],
        ),
        migrations.CreateModel(
            name='ModelFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('diagram', models.JSONField(blank=True, null=True)),
                ('summary', models.TextField(blank=True)),
                ('model_summaries', models.JSONField(blank=True, default=dict, null=True)),
                ('app', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='model_files', to='create_api.app')),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.modelfile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='project_model_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='MediaFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('file_type', models.CharField(choices=[('image', 'Image'), ('video', 'Video'), ('doc', 'Document'), ('other', 'Other')], max_length=50)),
                ('file', models.FileField(upload_to=create_api.models.project_upload_to)),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.mediafile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='media_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='FormFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('diagram', models.JSONField(blank=True, null=True)),
                ('summary', models.TextField(blank=True)),
                ('form_summaries', models.JSONField(blank=True, default=dict, null=True)),
                ('app', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='form_files', to='create_api.app')),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.formfile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='project_form_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='AppFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('app', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='app_files', to='create_api.app')),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.appfile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='app_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='TemplateFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_app_template', models.BooleanField(default=False)),
                ('app', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='app_template_files', to='create_api.app')),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.templatefile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='template_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='URLFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('app', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='app_url_files', to='create_api.app')),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.urlfile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='url_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='UserModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('model_name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('visibility', models.CharField(choices=[('private', 'Private'), ('public', 'Public')], default='private', max_length=10)),
                ('full_code', models.TextField(null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='ViewFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('diagram', models.JSONField(blank=True, null=True)),
                ('summary', models.TextField(blank=True)),
                ('view_summaries', models.JSONField(blank=True, default=dict, null=True)),
                ('app', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='view_files', to='create_api.app')),
                ('model_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='view_files', to='create_api.modelfile')),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.viewfile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='project_view_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='StaticFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('file_type', models.CharField(choices=[('css', 'CSS'), ('js', 'JavaScript'), ('img', 'Image'), ('other', 'Other')], max_length=50)),
                ('file', models.FileField(upload_to=create_api.models.project_upload_to)),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.staticfile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='static_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
                'indexes': [models.Index(fields=['path'], name='create_api__path_06058e_idx'), models.Index(fields=['is_folder'], name='create_api__is_fold_09516e_idx')],
            },
        ),
        migrations.CreateModel(
            name='SettingsFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.settingsfile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='settings_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
                'indexes': [models.Index(fields=['path'], name='create_api__path_f16f11_idx'), models.Index(fields=['is_folder'], name='create_api__is_fold_65850f_idx')],
            },
        ),
        migrations.CreateModel(
            name='ProjectFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('path', models.CharField(help_text='Relative path from project root', max_length=512)),
                ('name', models.CharField(max_length=255)),
                ('content', models.TextField(blank=True)),
                ('description', models.TextField(blank=True)),
                ('is_folder', models.BooleanField(default=False)),
                ('keywords', models.TextField(blank=True, default='', help_text='Searchable keywords')),
                ('content_hash', models.CharField(blank=True, max_length=64, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('parent_folder', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='create_api.projectfile')),
                ('project', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='project_files', to='create_api.project')),
                ('tags', models.ManyToManyField(blank=True, related_name='%(class)ss', related_query_name='%(class)s', to='create_api.tag')),
            ],
            options={
                'ordering': ['path'],
                'abstract': False,
                'indexes': [models.Index(fields=['path'], name='create_api__path_09c4d9_idx'), models.Index(fields=['is_folder'], name='create_api__is_fold_aabad1_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='project',
            index=models.Index(fields=['user', 'name'], name='create_api__user_id_7abee9_idx'),
        ),
        migrations.AddIndex(
            model_name='project',
            index=models.Index(fields=['created_at'], name='create_api__created_31dd7c_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='project',
            unique_together={('user', 'name')},
        ),
        migrations.AddIndex(
            model_name='modelfile',
            index=models.Index(fields=['path'], name='create_api__path_39bb8f_idx'),
        ),
        migrations.AddIndex(
            model_name='modelfile',
            index=models.Index(fields=['is_folder'], name='create_api__is_fold_af586f_idx'),
        ),
        migrations.AddIndex(
            model_name='mediafile',
            index=models.Index(fields=['path'], name='create_api__path_16abb4_idx'),
        ),
        migrations.AddIndex(
            model_name='mediafile',
            index=models.Index(fields=['is_folder'], name='create_api__is_fold_a064fe_idx'),
        ),
        migrations.AddIndex(
            model_name='formfile',
            index=models.Index(fields=['path'], name='create_api__path_dbc52e_idx'),
        ),
        migrations.AddIndex(
            model_name='formfile',
            index=models.Index(fields=['is_folder'], name='create_api__is_fold_d2db5f_idx'),
        ),
        migrations.AddIndex(
            model_name='appfile',
            index=models.Index(fields=['path'], name='create_api__path_ba6026_idx'),
        ),
        migrations.AddIndex(
            model_name='appfile',
            index=models.Index(fields=['is_folder'], name='create_api__is_fold_22daf9_idx'),
        ),
        migrations.AddIndex(
            model_name='app',
            index=models.Index(fields=['project', 'name'], name='create_api__project_5611c6_idx'),
        ),
        migrations.AddIndex(
            model_name='app',
            index=models.Index(fields=['created_at'], name='create_api__created_f819dc_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='app',
            unique_together={('project', 'name')},
        ),
        migrations.AddIndex(
            model_name='templatefile',
            index=models.Index(fields=['path'], name='create_api__path_8a99d5_idx'),
        ),
        migrations.AddIndex(
            model_name='templatefile',
            index=models.Index(fields=['is_folder'], name='create_api__is_fold_f53f24_idx'),
        ),
        migrations.AddIndex(
            model_name='urlfile',
            index=models.Index(fields=['path'], name='create_api__path_767901_idx'),
        ),
        migrations.AddIndex(
            model_name='urlfile',
            index=models.Index(fields=['is_folder'], name='create_api__is_fold_eacf75_idx'),
        ),
        migrations.AddIndex(
            model_name='viewfile',
            index=models.Index(fields=['path'], name='create_api__path_ff76cc_idx'),
        ),
        migrations.AddIndex(
            model_name='viewfile',
            index=models.Index(fields=['is_folder'], name='create_api__is_fold_e25e35_idx'),
        ),
    ]
